<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hb.mapper.DormitoryPartBedMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.hb.entity.DormitoryPartBed">
        <id column="ID" property="id" />
        <result column="BED_ID" property="bedId" />
        <result column="PART_ID" property="partId" />
        <result column="CREATE_DATE" property="createDate" />
        <result column="Operator_id" property="operatorId" />
        <result column="STATE" property="state" />
    </resultMap>

    <select id="selectPartBed" resultType="java.util.Map"
            parameterType="java.util.Map">

        SELECT
        partbed.*,bed.`BED_CODE`,bed.`BED_CODE`,bed.`BED_NUMBER`,dorm.`BUILDING_NAME`,bu.`BUILDING_NAME`
        FROM
        `dormitory_part_bed` partbed,
        `sys_bed` bed,
        `sys_dorm` dorm,
        `sys_build` bu

        WHERE partbed.`BED_ID` = bed.`ID`
        AND dorm.`ID`=bed.`DORM_ID`
        AND bu.`ID`=dorm.`BUILDING_ID`

        <if test="param.bedIdList != null and param.bedIdList != ''">
            <foreach collection="list" item="bedId" index="index" open="(" close=")" separator=",">
                #{bedIdList}
            </foreach>
        </if>

        <if test="param.partId != null and param.partId != ''">
            and partbed.PART_ID = #{param.partId,jdbcType=VARCHAR}
        </if>
        order by dorm.`DORM_CODE`

    </select>

</mapper>
